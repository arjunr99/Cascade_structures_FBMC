%%% Function returns a group of carriers.. 3^n_level number of carriers are
%%% generated.. better work on 3^4(81) carriers.. columns of y are carriers

function y = wave_pac(n_level)

% lp = [0.00415955349269808,-0.0322619501583841,0.0331877260746093,0.00531457669437846,0.0269702820690803,-0.0487747987014859,-0.00958611364305032,-0.0142949672709643,0.0474486660200702,0.0226650354413963,0.0254462807971648,-0.0638243958841509,-0.0309144299927090,-0.0159990362372761,0.0737886427749667,0.0671307693625874,0.0645497774460548,-0.0531041371186941,-0.0407392086532462,-0.0134096610449986,0.153544387424301,0.250247117340266,0.343195148253848,0.240523336544506,0.155353142120925,-0.0149448949567026,-0.0254854199006994,-0.102901444226848,-0.0423588859887615,-0.0286524821641840,0.0126043353969356,0.00644124042427325,0.00468180826409453];
% hp1 = [-0.0317434831134091 + 0.00503543090020750i,0.0501798798659275 + 0.0346163749331853i,0.0164220388392283 - 0.0611816284089411i,0.0584269795605990 - 0.00885218762668967i,-0.117115022891217 - 0.164279470501217i,-0.139352460015905 + 0.299285682664963i,0.320792271784004 - 0.0118294760021089i,-0.114791867581512 - 0.180061862267549i,-0.0310779781041501 + 0.0406749775041922i,-0.0476680413428917 + 0.00384931896853869i,0.0416413702828377 + 0.0553986891686740i,-0.00353050575915847 + 0.00820773788965707i,0.0491905216213287 + 0.0141600665444561i,-0.0350329583717974 - 0.0548204704933778i,-0.00696253566986577 + 0.00198259107070447i,-0.0211922501690164 - 0.00323611002041793i,0.0202579965582855 + 0.0425385472253455i,0.00360081698020603 + 0.00690163773665972i,0.0141964053327720 + 0.00999763948577566i,-0.0133008117201205 - 0.0286190641699503i,-0.00434975233139522 - 0.00421580714615239i,-0.00973366240220488 - 0.00600044291590925i,0.00687395913068875 + 0.0241768043366568i,0.00315479266195763 + 0.0116456353198613i,0.00684991350038585 + 0.0125990076374356i,-0.00358216817850750 - 0.0126746443488487i,-0.00350706330889083 - 0.0116721005528275i,-0.00721426314205849 - 0.0195253810017413i,-0.00252728115789020 - 0.00689305718075881i,-0.00159479217850442 - 0.00436587241398239i,0.00142894170382476 + 0.00380213403045363i,0.000730237396637646 + 0.00194301870302635i,0.000530772219811178 + 0.00141228093067887i];
% hp2 = [-0.0317434831134091 - 0.00503543090020750i,0.0501798798659275 - 0.0346163749331853i,0.0164220388392283 + 0.0611816284089411i,0.0584269795605990 + 0.00885218762668967i,-0.117115022891217 + 0.164279470501217i,-0.139352460015905 - 0.299285682664963i,0.320792271784004 + 0.0118294760021089i,-0.114791867581512 + 0.180061862267549i,-0.0310779781041501 - 0.0406749775041922i,-0.0476680413428917 - 0.00384931896853869i,0.0416413702828377 - 0.0553986891686740i,-0.00353050575915847 - 0.00820773788965707i,0.0491905216213287 - 0.0141600665444561i,-0.0350329583717974 + 0.0548204704933778i,-0.00696253566986577 - 0.00198259107070447i,-0.0211922501690164 + 0.00323611002041793i,0.0202579965582855 - 0.0425385472253455i,0.00360081698020603 - 0.00690163773665972i,0.0141964053327720 - 0.00999763948577566i,-0.0133008117201205 + 0.0286190641699503i,-0.00434975233139522 + 0.00421580714615239i,-0.00973366240220488 + 0.00600044291590925i,0.00687395913068875 - 0.0241768043366568i,0.00315479266195763 - 0.0116456353198613i,0.00684991350038585 - 0.0125990076374356i,-0.00358216817850750 + 0.0126746443488487i,-0.00350706330889083 + 0.0116721005528275i,-0.00721426314205849 + 0.0195253810017413i,-0.00252728115789020 + 0.00689305718075881i,-0.00159479217850442 + 0.00436587241398239i,0.00142894170382476 - 0.00380213403045363i,0.000730237396637646 - 0.00194301870302635i,0.000530772219811178 - 0.00141228093067887i];

% lp = [-0.0571289521206599,0.00664357454871256,0.0420491477390493,0.136368288143787,0.0623037370841225,-0.0290925602101885,-0.185274104265735,-0.197876716805749,-0.159851057137874,0.0525919319828031,0.152279869876949,0.252483177624445,0.188955243212529,0.172233754334059,0.0805963256173302,0.136324820060425,0.0965139095636935,0.108150137002654,0.0516971948451439,0.0315122368889738,0.0272213179954167,0.00979891147503975,0.00972296784257201,0.0117768447025001];
% hp1 = [0.0701177655040844 - 0.0257958109284379i,-0.0473938761953022 - 0.0310494600682876i,-0.0192130106608540 + 0.0470978248842884i,0.0179308031507851 + 0.0140221623134666i,-0.0329423339822502 - 0.101488777263806i,-0.124295292544762 + 0.159577066237068i,0.310013093870074 + 0.0236986336338941i,-0.128431280398253 - 0.257379062155319i,-0.101996361638204 + 0.154479344562449i,-0.0253821508860462 + 0.00365458420056080i,0.0490045667114033 + 0.114161023747663i,0.102642886751607 - 0.120079163454264i,-0.0627859087413159 - 0.0292713907645335i,-0.0175418567251405 - 0.00433987179128392i,-0.0333383430433928 + 0.0744409271365455i,0.00789069086561864 + 0.0134299519143644i,0.000869582065894157 - 0.0153616489260302i,0.000833357318742815 - 0.0386656697145617i,0.0127457131828397 + 0.00349254108434213i,0.00698693184096845 + 0.00998829493015162i,0.00533091276704612 + 0.0157075949951654i,0.00280332638729321 - 0.00323067145365661i,0.00278160001601350 - 0.00320563306790065i,0.00336918438314996 - 0.00388279005187766i];
% hp2 = [0.0701177655040844 + 0.0257958109284379i,-0.0473938761953022 + 0.0310494600682876i,-0.0192130106608540 - 0.0470978248842884i,0.0179308031507851 - 0.0140221623134666i,-0.0329423339822502 + 0.101488777263806i,-0.124295292544762 - 0.159577066237068i,0.310013093870074 - 0.0236986336338941i,-0.128431280398253 + 0.257379062155319i,-0.101996361638204 - 0.154479344562449i,-0.0253821508860462 - 0.00365458420056080i,0.0490045667114033 - 0.114161023747663i,0.102642886751607 + 0.120079163454264i,-0.0627859087413159 + 0.0292713907645335i,-0.0175418567251405 + 0.00433987179128392i,-0.0333383430433928 - 0.0744409271365455i,0.00789069086561864 - 0.0134299519143644i,0.000869582065894157 + 0.0153616489260302i,0.000833357318742815 + 0.0386656697145617i,0.0127457131828397 - 0.00349254108434213i,0.00698693184096845 - 0.00998829493015162i,0.00533091276704612 - 0.0157075949951654i,0.00280332638729321 + 0.00323067145365661i,0.00278160001601350 + 0.00320563306790065i,0.00336918438314996 + 0.00388279005187766i];

lp = [0.00134555141587422,-0.00213467947531799,0.00118177396087665,0.00937145897170735,-0.0172343739316859,0.00480580125327068,-0.00608687379243608,0.0226840223408541,-0.00754243652861006,0.000450804018744963,-0.0239096134040542,0.0103560512924357,0.00246047907570725,0.0249295081171344,-0.0106923939706620,-0.00635395943784451,-0.0266116578654577,0.0118697837021951,0.00932790383855120,0.0282501094678318,-0.0106892897709306,-0.0132780289222847,-0.0320617191935120,0.0115227821912829,0.0160930412445583,0.0357598450786920,-0.00945590151157942,-0.0199321540599914,-0.0416094616821549,0.00839355872526718,0.0223468639620095,0.0478709302996685,-0.00320594476678722,-0.0252380047730989,-0.0570031130572517,-0.00263003671812761,0.0254388000846828,0.0672107754548319,0.0152468171317467,-0.0234968016772004,-0.0804414842433532,-0.0328587320527075,0.0129812497450407,0.0932783048511423,0.0646192372919098,0.0137486874798094,-0.0986355744724586,-0.108317690011270,-0.0769803207492906,0.0753459150469940,0.186306973875845,0.292411686034440,0.266907265155696,0.227152836566270,0.104055489115533,0.0544861876721069,-0.0214521114178772,-0.00451558275773195,-0.00329533552887569,-0.00139052321313948,-0.000816954128740761,-0.000452514255778048,0.000112780358127334];
hp1 = [0.00172464402720870 - 0.00521194101506587i,-0.00273610955560766 + 0.00826861013757644i,0.00151468289505132 - 0.00457750602019091i,-0.0163153739140053 + 0.0265285413205100i,0.0125260139322163 - 0.0205959977608493i,-0.0601446634157895 + 0.0860112906453093i,0.225188358182117 - 0.0228528697520654i,-0.184687759543580 - 0.254666899399810i,-0.119871856875210 + 0.276825745742746i,0.187276935940344 - 0.00437735876454294i,0.000779938090181178 - 0.0293835130609003i,0.0160481137112826 - 0.0939186210027463i,-0.106054796106725 + 0.0206034436444862i,0.0216711749851543 + 0.0269658248362722i,-0.00591942708410896 + 0.0442546960644375i,0.0742054813847767 - 0.0134512626893173i,-0.0246588512231585 - 0.0238444202601131i,0.00403586823310306 - 0.0227528622834374i,-0.0554895052847972 + 0.00553665776238668i,0.0220347218347677 + 0.0185867100316296i,-0.000588686282805142 + 0.0134934936570325i,0.0432043818196436 - 0.00114582132820884i,-0.0185687758073224 - 0.0157492943784837i,-0.00111246887446154 - 0.00970716194094953i,-0.0338672326861351 - 0.00230074891015169i,0.0158453328250751 + 0.0127233037003133i,0.00256474885011302 + 0.00697363732748821i,0.0275634313790391 + 0.00366368294428836i,-0.0127029977934863 - 0.0110895850687435i,-0.00290568652392082 - 0.00612852367298025i,-0.0223912395447581 - 0.00523879308246543i,0.0103734186675938 + 0.00873276858458934i,0.00342977054495263 + 0.00479356716999339i,0.0190388450119442 + 0.00543264147591462i,-0.00761283235809253 - 0.00750553890381570i,-0.00313835879863845 - 0.00464651504311600i,-0.0159962804874434 - 0.00626904471341110i,0.00559061370322283 + 0.00543642882984310i,0.00316146793059794 + 0.00371978980378097i,0.0141721010193255 + 0.00607001897417985i,-0.00304917475805623 - 0.00435333035019153i,-0.00240709897612212 - 0.00381719502472899i,-0.0122182410784126 - 0.00685823538417832i,0.00108617050005583 + 0.00206911684822576i,0.00178294421513175 + 0.00272455291406962i,0.0109220340391125 + 0.00664436766264367i,0.00133539113805019 - 0.000396406430938079i,-0.000283288843545615 - 0.00182668080150194i,-0.00900910117471292 - 0.00657099414946505i,-0.00309576940915041 - 0.00182185581588235i,-0.00128053307270314 - 8.54416455178114e-05i,0.00714177908143766 + 0.00534970391274392i,0.00516884995570165 + 0.00339460668040117i,0.00445701163364083 + 0.00239110364637675i,-0.00258469569429512 - 0.00284157366241135i,-0.00400337532189477 - 0.00377492261697120i,-0.00593510326885958 - 0.00499673894008596i,-0.00297015002314259 - 0.00253611653392460i,-0.00184740975871857 - 0.00157419506439423i,-0.000102822774051997 - 7.95569727199023e-05i,-0.000208042295287715 - 0.000174298020823452i,-0.000115235483989274 - 9.65443914189937e-05i,2.87201982862204e-05 + 2.40618077781845e-05i];
hp2 = [0.00172464402720870 + 0.00521194101506587i,-0.00273610955560766 - 0.00826861013757644i,0.00151468289505132 + 0.00457750602019091i,-0.0163153739140053 - 0.0265285413205100i,0.0125260139322163 + 0.0205959977608493i,-0.0601446634157895 - 0.0860112906453093i,0.225188358182117 + 0.0228528697520654i,-0.184687759543580 + 0.254666899399810i,-0.119871856875210 - 0.276825745742746i,0.187276935940344 + 0.00437735876454294i,0.000779938090181178 + 0.0293835130609003i,0.0160481137112826 + 0.0939186210027463i,-0.106054796106725 - 0.0206034436444862i,0.0216711749851543 - 0.0269658248362722i,-0.00591942708410896 - 0.0442546960644375i,0.0742054813847767 + 0.0134512626893173i,-0.0246588512231585 + 0.0238444202601131i,0.00403586823310306 + 0.0227528622834374i,-0.0554895052847972 - 0.00553665776238668i,0.0220347218347677 - 0.0185867100316296i,-0.000588686282805142 - 0.0134934936570325i,0.0432043818196436 + 0.00114582132820884i,-0.0185687758073224 + 0.0157492943784837i,-0.00111246887446154 + 0.00970716194094953i,-0.0338672326861351 + 0.00230074891015169i,0.0158453328250751 - 0.0127233037003133i,0.00256474885011302 - 0.00697363732748821i,0.0275634313790391 - 0.00366368294428836i,-0.0127029977934863 + 0.0110895850687435i,-0.00290568652392082 + 0.00612852367298025i,-0.0223912395447581 + 0.00523879308246543i,0.0103734186675938 - 0.00873276858458934i,0.00342977054495263 - 0.00479356716999339i,0.0190388450119442 - 0.00543264147591462i,-0.00761283235809253 + 0.00750553890381570i,-0.00313835879863845 + 0.00464651504311600i,-0.0159962804874434 + 0.00626904471341110i,0.00559061370322283 - 0.00543642882984310i,0.00316146793059794 - 0.00371978980378097i,0.0141721010193255 - 0.00607001897417985i,-0.00304917475805623 + 0.00435333035019153i,-0.00240709897612212 + 0.00381719502472899i,-0.0122182410784126 + 0.00685823538417832i,0.00108617050005583 - 0.00206911684822576i,0.00178294421513175 - 0.00272455291406962i,0.0109220340391125 - 0.00664436766264367i,0.00133539113805019 + 0.000396406430938079i,-0.000283288843545615 + 0.00182668080150194i,-0.00900910117471292 + 0.00657099414946505i,-0.00309576940915041 + 0.00182185581588235i,-0.00128053307270314 + 8.54416455178114e-05i,0.00714177908143766 - 0.00534970391274392i,0.00516884995570165 - 0.00339460668040117i,0.00445701163364083 - 0.00239110364637675i,-0.00258469569429512 + 0.00284157366241135i,-0.00400337532189477 + 0.00377492261697120i,-0.00593510326885958 + 0.00499673894008596i,-0.00297015002314259 + 0.00253611653392460i,-0.00184740975871857 + 0.00157419506439423i,-0.000102822774051997 + 7.95569727199023e-05i,-0.000208042295287715 + 0.000174298020823452i,-0.000115235483989274 + 9.65443914189937e-05i,2.87201982862204e-05 - 2.40618077781845e-05i];

wave_len = length(lp);
if(n_level>0)
    ind = ((3^n_level-1)*wave_len - (3^(n_level-1) - 1))/2;
    y = zeros(ind,3^n_level);
    y1 = wave_pac(n_level-1);
    for l=1:3^(n_level-1)
        temp = conv(upsample(y1(:,l),3),lp);
        y(:,3*l-2) = temp(1:ind).';
        temp = conv(upsample(y1(:,l),3),hp1);
        y(:,3*l-1) = temp(1:ind).';
        temp = conv(upsample(y1(:,l),3),hp2);
        y(:,3*l) = temp(1:ind).';
    end
    
else
    y(1,1)=1;
    y(1,2)=1;
    y(1,3)=1;
end   
end